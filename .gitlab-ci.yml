image: "python:3.7-stretch"

stages:
  - test
  - build

pylint:
  stage: test
  script:
    - pip install -r requirements.txt
    - pip install pylint
    - ci/pylint_runner.sh
  allow_failure: true

tests:
  stage: test
  only:
    - master
    - develop
    - feature/ci
  script:
    - pip install -r requirements.txt
    - pip install coverage
    - ci/tests_runner.sh
  artifacts:
    paths:
      - report.txt
    expire_in: 1 week

pyinstaller:
  stage: build
  only:
    - master
    - develop
    - feature/ci
  script:
    - pip install -r requirements.txt
    - pip install pyinstaller
    - wget https://bootstrap.pypa.io/ez_setup.py -O - | python
    - pyinstaller game.py -p . -F
  artifacts:
    paths:
      - dist
    expire_in: 1 week